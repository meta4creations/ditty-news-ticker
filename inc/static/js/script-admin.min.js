/* global CodeMirror:true */
/* global wp:true */
/* global ditty_news_ticker_vars:true */
/* global ajaxurl:true */
/* global tinyMCE:true */
// @codekit-append '/partials/mtphr-dnt-affix.js';
// @codekit-append '/partials/admin-general.js';
/* ========================================================================
 * Bootstrap: mtphr_dnt_affix.js v3.3.5
 * http://getbootstrap.com/javascript/#mtphr_dnt_affix
 * ========================================================================
 * Copyright 2011-2015 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */
!function(h){"use strict";
// AFFIX CLASS DEFINITION
// ======================
// AFFIX PLUGIN DEFINITION
// =======================
function i(n){return this.each(function(){var t=h(this),e=t.data("bs.mtphr_dnt_affix"),i="object"==typeof n&&n;e||t.data("bs.mtphr_dnt_affix",e=new d(this,i)),"string"==typeof n&&e[n]()})}var d=function(t,e){this.options=h.extend({},d.DEFAULTS,e),this.$target=h(this.options.target).on("scroll.bs.mtphr_dnt_affix.data-api",h.proxy(this.checkPosition,this)).on("click.bs.mtphr_dnt_affix.data-api",h.proxy(this.checkPositionWithEventLoop,this)),this.$element=h(t),this.mtphr_dnt_affixed=null,this.unpin=null,this.pinnedOffset=null,this.checkPosition()};d.VERSION="3.3.5",d.RESET="mtphr_dnt_affix mtphr_dnt_affix-top mtphr_dnt_affix-bottom",d.DEFAULTS={offset:0,target:window},d.prototype.getState=function(t,e,i,n){var r=this.$target.scrollTop(),a=this.$element.offset(),o=this.$target.height();if(null!==i&&"top"===this.mtphr_dnt_affixed)return r<i&&"top";if("bottom"===this.mtphr_dnt_affixed)return null!==i?!(r+this.unpin<=a.top)&&"bottom":!(r+o<=t-n)&&"bottom";var s=null===this.mtphr_dnt_affixed,h=s?r:a.top,d;return null!==i&&r<=i?"top":null!==n&&t-n<=h+(s?o:e)&&"bottom"},d.prototype.getPinnedOffset=function(){if(this.pinnedOffset)return this.pinnedOffset;this.$element.removeClass(d.RESET).addClass("mtphr_dnt_affix");var t=this.$target.scrollTop(),e=this.$element.offset();return this.pinnedOffset=e.top-t},d.prototype.checkPositionWithEventLoop=function(){setTimeout(h.proxy(this.checkPosition,this),1)},d.prototype.checkPosition=function(){if(this.$element.is(":visible")){var t=this.$element.height(),e=this.options.offset,i=e.top,n=e.bottom,r=Math.max(h(document).height(),h(document.body).height());"object"!=typeof e&&(n=i=e),"function"==typeof i&&(i=e.top(this.$element)),"function"==typeof n&&(n=e.bottom(this.$element));var a=this.getState(r,t,i,n);if(this.mtphr_dnt_affixed!==a){null!==this.unpin&&this.$element.css("top","");var o="mtphr_dnt_affix"+(a?"-"+a:""),s=h.Event(o+".bs.mtphr_dnt_affix");if(this.$element.trigger(s),s.isDefaultPrevented())return;this.mtphr_dnt_affixed=a,this.unpin="bottom"===a?this.getPinnedOffset():null,this.$element.removeClass(d.RESET).addClass(o).trigger(o.replace("mtphr_dnt_affix","mtphr_dnt_affixed")+".bs.mtphr_dnt_affix")}"bottom"===a&&this.$element.offset({top:r-t-n})}};var t=h.fn.mtphr_dnt_affix;h.fn.mtphr_dnt_affix=i,h.fn.mtphr_dnt_affix.Constructor=d,
// AFFIX NO CONFLICT
// =================
h.fn.mtphr_dnt_affix.noConflict=function(){return h.fn.mtphr_dnt_affix=t,this},
// AFFIX DATA-API
// ==============
h(window).on("load",function(){h('[data-spy="mtphr_dnt_affix"]').each(function(){var t=h(this),e=t.data();e.offset=e.offset||{},null!==e.offsetBottom&&(e.offset.bottom=e.offsetBottom),null!==e.offsetTop&&(e.offset.top=e.offsetTop),i.call(t,e)})})}(jQuery),jQuery(document).ready(function(o){
/* --------------------------------------------------------- */
/* !Metabox toggles - 2.0.0 */
/* --------------------------------------------------------- */
function e(t,e){
// Set the metaboxes
o("#mtphr-dnt-"+e+"-metaboxes > div").stop(!0,!0).hide();for(var i=t.attr("metabox").split(" "),n=0;n<i.length;n++)o("#"+i[n]).show();
// Set the button classes
t.siblings("a").removeClass("button-primary"),t.addClass("button-primary"),
// Store the new value
t.siblings("input").val(t.attr("href").substring(1))}
/* --------------------------------------------------------- */
/* !Mixed tick list - 2.0.0 */
/* --------------------------------------------------------- */
function t(t){var e;t.find("input").is(":checked")?t.next().fadeOut():t.next().fadeIn()}var i=o("#mtphr-dnt-settings-select"),n=o("#wpadminbar");
/* --------------------------------------------------------- */
/* !Affix the menu bar - 2.0.1 */
/* --------------------------------------------------------- */i.mtphr_dnt_affix({offset:{top:function(){return o(window).width()<601?this.top=i.offset().top+5:this.top=i.offset().top-n.height()+5}}}),
/* --------------------------------------------------------- */
/* !Main settings selects - 2.0.0 */
/* --------------------------------------------------------- */
o(".mtphr-dnt-metabox-group-toggle").click(function(t){t.preventDefault();var e=o(this).attr("href");o(".mtphr-dnt-metabox-group-toggle").removeClass("active"),o(".mtphr-dnt-metabox-group").removeClass("active"),o(this).addClass("active"),o(e).addClass("active"),
// Set the input data
o('input[name="_mtphr_dnt_admin_tab"]').val(e)}),
/* --------------------------------------------------------- */
/* !Initiate the CodeMirror fields - 1.4.0 */
/* --------------------------------------------------------- */
o(".mtphr-dnt-codemirror-css").each(function(){var t=o(this).children("textarea");CodeMirror.fromTextArea(t[0],{mode:"css",lineNumbers:!0,lineWrapping:!0,viewportMargin:1/0})}),o(".mtphr-dnt-codemirror-js").each(function(){var t=o(this).children("textarea"),e;CodeMirror.fromTextArea(t[0],{mode:"htmlmixed",lineNumbers:!0,lineWrapping:!0}).setSize(!1,140)}),
/* --------------------------------------------------------- */
/* !Code select - 1.4.0 */
/* --------------------------------------------------------- */
o(".mtphr-dnt-code-select").click(function(t){t.preventDefault();var e,i,n,r=o(this).siblings("pre")[0];o.browser.msie?((i=document.body.createTextRange()).moveToElementText(r),i.select()):o.browser.mozilla||o.browser.opera?(n=window.getSelection(),(i=document.createRange()).selectNodeContents(r),n.removeAllRanges(),n.addRange(i)):(o.browser.safari||o.browser.chrome)&&(n=window.getSelection()).setBaseAndExtent(r,0,r,1)}),
/* --------------------------------------------------------- */
/* !Ensure javascript is working - 2.0.0 */
/* --------------------------------------------------------- */
o('input[name="_mtphr_dnt_admin_javascript"]').length&&o('input[name="_mtphr_dnt_admin_javascript"]').val("ok"),o(".mtphr-dnt-type-toggle.button-primary").length&&e(o(".mtphr-dnt-type-toggle.button-primary"),"type"),o(".mtphr-dnt-mode-toggle.button-primary").length&&e(o(".mtphr-dnt-mode-toggle.button-primary"),"mode"),o(".mtphr-dnt-type-toggle").click(function(t){t.preventDefault(),o(this).hasClass("button-primary")||e(o(this),"type")}),o(".mtphr-dnt-mode-toggle").click(function(t){t.preventDefault(),o(this).hasClass("button-primary")||e(o(this),"mode")}),
/* --------------------------------------------------------- */
/* !Sort list - 1.4.4 */
/* --------------------------------------------------------- */
0<o(".mtphr-dnt-sort").length&&(o(".mtphr-dnt-sort").sortable({handle:".mtphr-dnt-sort-heading",items:".mtphr-dnt-sort-item",axis:"y",opacity:.7,placeholder:{element:function(t){var e=o(t).innerHeight();return o('<div class="mtphr-dnt-sort-placeholder" style="height:'+e+'px;"></div>')[0]},update:function(){}},helper:function(t,e){var i=e.children(),n=e.clone();return n.children().each(function(t){o(this).width(i.eq(t).width()),o(this).height(i.eq(t).height())}),n}}),o(".mtphr-dnt-sort-heading.optional").live("click",function(t){t.preventDefault();var e=o(this).parents(".mtphr-dnt-sort-item"),i=o(this).next(".mtphr-dnt-sort-item-fields"),n=o(this).children("input");e.hasClass("active")?(e.removeClass("active"),n.val("off"),i.length&&i.stop(!0,!0).slideUp(1e3,"easeOutQuint")):(e.addClass("active"),n.val("on"),i.length&&i.stop(!0,!0).slideDown(1e3,"easeOutQuint"))}))
/* --------------------------------------------------------- */
/* !List - 2.0.0 */
/* --------------------------------------------------------- */,o(".mtphr-dnt-list").mtphr_dnt_list(),
/* --------------------------------------------------------- */
/* !Single image upload - 2.0.0 */
/* --------------------------------------------------------- */
// Delete an image
o(".mtphr-dnt-single-image").find(".mtphr-dnt-delete").live("click",function(t){t.preventDefault();var e=o(this).parent(),i=e.siblings(".mtphr-dnt-single-image-upload"),n;e.siblings("input").val(""),e.remove(),i.show()}),
// Add an image
o(".mtphr-dnt-single-image-upload").live("click",function(t){t.preventDefault();
// Save the container
var i=o(this),n=i.parent(),r=n.children("input"),a;
// Create a custom uploader
if(!a)
// Set the uploader attributes
return(a=wp.media({title:ditty_news_ticker_vars.img_title,button:{text:ditty_news_ticker_vars.img_button,size:"small"},multiple:!1,library:{type:"image"}})).on("select",function(){var t=a.state().get("selection").toJSON();if(0<t.length){r.val(t[0].id);
// Create the display
var e={action:"mtphr_dnt_single_image_ajax",attachment:t[0],security:ditty_news_ticker_vars.security};jQuery.post(ajaxurl,e,function(t){i.hide(),n.append(t)})}}),
//Open the uploader dialog
a.open(),!1;a.open()});
/* --------------------------------------------------------- */
/* !Tool tips - 2.0.0 */
/* --------------------------------------------------------- */
var r={content:{attr:"data-tooltip"},style:{classes:"qtip-light qtip-rounded qtip-shadow"}};o('.mtphr-dnt-help[data-tooltip!=""]').qtip(r),o("body").on("click",'.mtphr-dnt-help[data-tooltip!=""]',function(t){t.preventDefault()}),o(".mtphr-dnt-list-field-mtphr_dnt_mixed_ticks_all").find("input").live("click",function(){t(o(this).parents(".mtphr-dnt-list-field-mtphr_dnt_mixed_ticks_all"))}),o(".mtphr-dnt-list-field-mtphr_dnt_mixed_ticks_all").each(function(){t(o(this))})}),
/* --------------------------------------------------------- */
/* !List */
/* --------------------------------------------------------- */
function(s){var e={init:function(i){return this.each(function(){function t(){1<a.find(".mtphr-dnt-list-item").length?(a.find(".mtphr-dnt-list-handle").show(),a.find(".mtphr-dnt-list-delete").show()):(a.find(".mtphr-dnt-list-handle").hide(),a.find(".mtphr-dnt-list-delete").hide())}function r(){a.find(".mtphr-dnt-list-item").each(function(n){s(this).find("textarea, input, select").each(function(){var t,e;if(s(this).hasClass("wp-editor-area")){var i=s(this).parents(".mtphr-dnt-field-type-wysiwyg");t=i.attr("data-name"),e=i.attr("data-key")}else t=s(this).attr("data-name"),e=s(this).attr("data-key");t&&e&&s(this).attr("name",t+"["+n+"]["+e+"]")})}),t()}function n(t,e){
// Save the container
var i=t.clone();
// Reset the duplicate
i.find("textarea, input, select").each(function(){"checkbox"===s(this).attr("type")||"radio"===s(this).attr("type")?s(this).removeAttr("checked"):s(this).val("")}),
// Setup new wysiwyg editors
i.find("textarea").each(function(){if(s(this).hasClass("wp-editor-area")){var n=s(this).parents(".mtphr-dnt-field-type-wysiwyg"),t=n.attr("data-name");n.children(".wp-core-ui").remove();
// Create the display
var e={action:"mtphr_dnt_wysiwyg_ajax",name:t,security:ditty_news_ticker_vars.security};jQuery.post(ajaxurl,e,function(t){var e,i=s(t).find("textarea").attr("id");n.append(t),"object"==typeof tinyMCE&&"function"==typeof tinyMCE.execCommand&&tinyMCE.execCommand("mceAddEditor",!1,i),
// Set the order
r()})}}),
// Add the duplicate
i.hide(),t.after(i),i.fadeIn().addClass(e),
// Add qtip support
i.find('.mtphr-dnt-help[data-tooltip!=""]').qtip(o),
// Set the order
r(),
// Trigger an added event
a.trigger("mtphr_dnt_list_item_added",[i,e])}
// Delete list item
// Create default options
var e={};
// Add any set options
i&&s.extend(e,i);var a=s(this),o={content:{attr:"data-tooltip"},style:{classes:"qtip-light qtip-rounded qtip-shadow"}};a.sortable({handle:".mtphr-dnt-list-heading",items:".mtphr-dnt-list-item",axis:"y",opacity:.7,placeholder:{element:function(t){var e=s(t).innerHeight();return s('<div class="mtphr-dnt-sort-placeholder" style="height:'+e+'px;"></div>')[0]},update:function(){}},helper:function(t,e){var i=e.children(),n=e.clone();return n.children().each(function(t){s(this).width(i.eq(t).width()),s(this).height(i.eq(t).height())}),n}}),a.find(".mtphr-dnt-list-delete").live("click",function(t){t.preventDefault(),
// Fade out the item
s(this).parents(".mtphr-dnt-list-item").fadeOut(function(){s(this).remove(),r()})}),
// Add new row
a.find(".mtphr-dnt-list-add").live("click",function(t){t.preventDefault(),n(s(this).parents(".mtphr-dnt-list-item"))}),a.on("mtphr_dnt_list_add_item",function(t,e,i){n(e,i)}),r()})}};
/**
	 * Setup the list
	 *
	 * @since 1.0.0
	 */s.fn.mtphr_dnt_list=function(t){return e[t]?e[t].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof t&&t?void s.error("Method "+t+" does not exist in mtphr_dnt_list"):e.init.apply(this,arguments)}}(jQuery);