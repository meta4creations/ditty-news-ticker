(()=>{"use strict";const t={};let e=null;function i(){if(null!==e||Object.keys(t).length<1)return!1;cancelAnimationFrame(e);const i=dittyVars.updateInterval?parseInt(dittyVars.updateInterval):60;let a=Date.now();e=requestAnimationFrame(function s(){const n=Date.now();Math.floor((n-a)/1e3)>=i&&(a=n,fetch(`${dittyVars.restUrl}ditty/v1/live-updates`,{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":dittyVars.restNonce},body:JSON.stringify({live_ids:t})}).then(t=>t.json()).then(e=>{e.updated_items&&Object.entries(e.updated_items).forEach(([e,i])=>{!function(t,e){document.querySelectorAll(`.ditty[data-id="${t}"]`).forEach(i=>{const a=i.getAttribute("data-type");"development"===dittyVars.mode&&window.console&&console.log(`LIVE UPDATE: ${t}`),"function"==typeof i[`ditty_${a}`]&&i[`ditty_${a}`]("loadItems",e,"static")})}(e,i),t[e].timestamp=Math.floor(Date.now()/1e3)})})),e=requestAnimationFrame(s)})}const a=()=>{document.querySelectorAll(".ditty__contents .dittySlider").forEach(t=>{const e=t.dataset,i=JSON.parse(e.breakpoints||"[]").reduce((t,e)=>(t[`(max-width: ${e.maxWidth}px)`]={slides:{origin:e.center?"center":"auto",perView:e.perView,spacing:e.spacing}},t),{}),a={type:e.type,selector:e.selector,initial:parseInt(e.initial,10),autoheight:"true"===e.autoheight,loop:"true"===e.loop,mode:e.mode,vertical:"true"===e.vertical,transitionSpeed:parseInt(e.animationDuration,10),transitionEase:e.animationEasing,slides:{origin:"true"===e.center?"center":"auto",perView:parseInt(e.perView,10),spacing:parseInt(e.spacing,10)},breakpoints:i};new DittySlider(t,a)}),document.querySelectorAll(".ditty-gallery-slider").forEach(t=>{const e=t.querySelector(".dittySlider__slider");new DittySlider(e,{loop:!0,autoplay:!0,slides:{perView:1,spacing:0},selector:".ditty-gallery-item"})}),document.addEventListener("click",function(t){const e=t.target.closest(".ditty-item__media__link");if(!e)return;const i=t.target.closest(".dittySlider__bullet");i&&e.contains(i)&&(t.preventDefault(),t.stopPropagation())})};window.addEventListener("DOMContentLoaded",()=>{dittyVars.globals.forEach(t=>{if(!t.ditty||!t.selector)return;const e=document.querySelector(t.selector);if(!e)return;const i=document.createElement("div");switch(i.className="ditty",i.setAttribute("data-id",t.ditty),i.setAttribute("data-ajax_load","1"),t.display&&i.setAttribute("data-display",t.display),"1"===t.live_updates&&i.setAttribute("data-live_updates","1"),t.custom_id&&(i.id=t.custom_id),t.custom_classes&&i.classList.add(...t.custom_classes.split(" ")),t.edit_links&&(i.innerHTML=t.edit_links),t.position){case"prepend":e.prepend(i);break;case"before":e.parentNode.insertBefore(i,e);break;case"after":e.parentNode.insertBefore(i,e.nextSibling);break;default:e.appendChild(i)}}),document.querySelectorAll(".ditty").forEach(e=>{const a=e.dataset.id,s="1"===e.dataset.ajax_load,n="1"===e.dataset.live_updates,o=e.dataset.display_settings||!1,d=e.dataset.layout_settings||!1,r="1"===e.dataset.show_editor;if(s){const s={id:a,uniqid:e.dataset.uniqid||!1,display:e.dataset.display||"",display_settings:o,layout_settings:d,editor:r};fetch(`${dittyVars.restUrl}ditty/v1/init`,{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":dittyVars.restNonce},body:JSON.stringify(s)}).then(t=>t.json()).then(s=>{s.display_type&&"function"==typeof e[`ditty_${s.display_type}`]?(e[`ditty_${s.display_type}`](s.args),!r&&n&&(t[a]={timestamp:Math.floor(Date.now()/1e3),layout_settings:d},i())):console.log("Ditty Display type not loaded:",s.display_type)})}else!r&&n&&(t[a]={timestamp:Math.floor(Date.now()/1e3),layout_settings:d},i())}),a()})})();