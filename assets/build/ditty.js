!function(){"use strict";console.log("ditty.js");const t={};let e=null;function i(){if(null!==e||Object.keys(t).length<1)return!1;cancelAnimationFrame(e);const i=dittyVars.updateInterval?parseInt(dittyVars.updateInterval):60;let a=Date.now();e=requestAnimationFrame((function s(){const o=Date.now();Math.floor((o-a)/1e3)>=i&&(a=o,fetch(`${dittyVars.restUrl}ditty/v1/live-updates`,{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":dittyVars.restNonce},body:JSON.stringify({live_ids:t})}).then((t=>t.json())).then((e=>{e.updated_items&&Object.entries(e.updated_items).forEach((([e,i])=>{!function(t,e){document.querySelectorAll(`.ditty[data-id="${t}"]`).forEach((i=>{const a=i.getAttribute("data-type");"development"===dittyVars.mode&&window.console&&console.log(`LIVE UPDATE: ${t}`),"function"==typeof i[`ditty_${a}`]&&i[`ditty_${a}`]("loadItems",e,"static")}))}(e,i),t[e].timestamp=Math.floor(Date.now()/1e3)}))}))),e=requestAnimationFrame(s)}))}document.addEventListener("DOMContentLoaded",(function(){dittyVars.globals.forEach((t=>{if(!t.ditty||!t.selector)return;const e=document.querySelector(t.selector);if(!e)return;const i=document.createElement("div");switch(i.className="ditty",i.setAttribute("data-id",t.ditty),i.setAttribute("data-ajax_load","1"),t.display&&i.setAttribute("data-display",t.display),"1"===t.live_updates&&i.setAttribute("data-live_updates","1"),t.custom_id&&(i.id=t.custom_id),t.custom_classes&&i.classList.add(...t.custom_classes.split(" ")),t.edit_links&&(i.innerHTML=t.edit_links),t.position){case"prepend":e.prepend(i);break;case"before":e.parentNode.insertBefore(i,e);break;case"after":e.parentNode.insertBefore(i,e.nextSibling);break;default:e.appendChild(i)}})),document.querySelectorAll(".ditty-gallery-slider").forEach((t=>{const e=t.querySelector(".dittySlider__slider");new DittySlider(e,{loop:!0,autoplay:!0,slides:{perView:1,spacing:0},selector:".ditty-gallery-item"})})),document.querySelectorAll(".ditty").forEach((e=>{const a=e.dataset.id,s="1"===e.dataset.ajax_load,o="1"===e.dataset.live_updates,n=e.dataset.display_settings||!1,d=e.dataset.layout_settings||!1,l="1"===e.dataset.show_editor;if(s){const s={id:a,uniqid:e.dataset.uniqid||!1,display:e.dataset.display||"",display_settings:n,layout_settings:d,editor:l};fetch(`${dittyVars.restUrl}ditty/v1/init`,{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":dittyVars.restNonce},body:JSON.stringify(s)}).then((t=>t.json())).then((s=>{s.display_type&&"function"==typeof e[`ditty_${s.display_type}`]?(e[`ditty_${s.display_type}`](s.args),!l&&o&&(t[a]={timestamp:Math.floor(Date.now()/1e3),layout_settings:d},i())):console.log("Ditty Display type not loaded:",s.display_type)}))}else!l&&o&&(t[a]={timestamp:Math.floor(Date.now()/1e3),layout_settings:d},i())}))}))}(),document.addEventListener("click",(function(t){const e=t.target.closest(".ditty-item__media__link");if(!e)return;const i=t.target.closest(".dittySlider__bullet");i&&e.contains(i)&&(t.preventDefault(),t.stopPropagation())}));